{
  "title": "Balanced Fibonacci word rectangles, and beyond",
  "authors": [
    {
      "firstname": "Jeffrey",
      "surname": "Shallit",
      "email": "shallit@uwaterloo.ca"
    },
    {
      "firstname": "Ingrid",
      "surname": "Vukusic",
      "email": "ingrid.vukusic@york.ac.uk"
    },
    {
      "firstname": "",
      "surname": "",
      "email": ""
    },
    {
      "firstname": "",
      "surname": "",
      "email": ""
    }
  ],
  "abstract": "Following a recent paper of Anselmo et al., we consider m × n rectangular matrices formed from the Fibonacci word, and we show that their balance properties can be solved with a finite automaton. We also generalize the result to every Sturmian characteristic word corresponding to a quadratic irrational.",
  "sections": [
    {
      "title": "Introduction",
      "paragraphs": [
        "Let (a i ) i≥0 be an infinite sequence over {0, 1}. We can define an infinite matrix A = (a k,ℓ ) k,ℓ≥0 by a k,ℓ = a k+ℓ . Then we can view the m×n submatrices of A as matrices where the successive rows form shifted length-n \"windows\" of (a i ) i≥0 , and the entry in the upper left corner has index sum i: These are sometimes called Hankel matrices in the literature [10].",
        "The sum over all entries in the matrix A(i, m, n) equals",
        "It is clear that A(i, m, n) = A(i, n, m) for all i, m, n.",
        "The balance problem for (a i ) i≥0 is the following: for which pairs of natural numbers (m, n) are there at most two distinct values among all the (T (i, m, n)) i≥0 ? If this is the case, we say that the (m, n)-submatrices of A are balanced with respect to each other or just that (m, n) is balanced. This is a generalization of a more familiar notion of balance for binary words, one that has been well-studied [15].",
        "The famous infinite Fibonacci word f = f 0 f 1 f 2 • • • = 01001010 • • • has been the subject of numerous papers [3]. It can be defined via the formula",
        "for n ≥ 1, where γ = (3 -√ 5)/2. Recently Anselmo et al. [2] showed the following (their Theorem 18): for m, n ≥ 2, if max(m, n) is a Fibonacci number, then the m × n blocks of A γ are balanced. Also see [6]. However, there are still other (m, n) pairs with the balance property, such as (4,3). This raises the natural question, which (m, n) pairs are balanced for the Fibonacci word?",
        "In this note we prove a theorem (Corollary 3) characterizing exactly those pairs (m, n) that are balanced. Our characterization is in terms of finite automata. The particular result of Anselmo et al. then follows as a special case. More generally, we show how the same sort of characterization can be obtained for the matrices formed from any Sturmian word corresponding to a quadratic irrational α, and we show how to implement this in the free software Walnut."
      ],
      "subsections": []
    },
    {
      "title": "Sturmian words",
      "paragraphs": [
        "Let α ∈ (0, 1) be an irrational number, and define a i = ⌊(i + 1)α⌋ -⌊iα⌋ for i ≥ 1. The infinite word (a i ) i≥1 is sometimes called a Sturmian characteristic word [7,5]. Although by convention Sturmian words are indexed starting at 1, we can define a 0 = 0 without creating any new blocks that do not already appear in f , by a well-known result [5, 2.1.18].",
        "We now define the infinite matrix A α from the terms of (a i ) i≥1 ; we call A α a Sturmian matrix. By telescoping cancellation we see that",
        "Hence, from the definition (1), we get",
        "Note that for all x, y ≥ 0 we have ⌊x + y⌋ = ⌊x⌋ + ⌊y⌋ + δ with δ ∈ {0, 1}. Therefore,",
        "Define ∆(i, m, n) := T (i + 1, m, n) -T (i, m, n). The argument above then gives the following criterion for A(i, m, n) to be balanced. Lemma 1. If (a i ) i≥0 is a Sturmian word corresponding to the irrational number α, then in the matrix A α = (a i,j ) i,j≥0 the m×n blocks are balanced if and only if the sequence ∆(i, m, n) has no blocks of the form 1, 0, 0, . . . , 0, 1 or -1, 0, 0, . . . , 0, -1.",
        "Proof. The only thing left to show is that (∆(i, m, n)) i≥0 has a block of the form 1, 0, 0, . . . , 0, 1 or -1, 0, 0, . . . , 0, -1 if and only if (m, n) is not balanced.",
        "Suppose it does have a block of the form a, 0, 0, . . . , 0, a for a ∈ {-1, 1}; say there are",
        "Then by telescoping cancellation we have",
        "Without loss of generality we may assume that j -i is as small as possible. Since from Eq. ( 3) we know that ∆(i, m, n) ∈ {-1, 0, 1}, it follows that we must have ∆(j) = a, ∆(i) = a, and ∆(k) = 0 for i < k < j and a ∈ {-1, 1}."
      ],
      "subsections": []
    },
    {
      "title": "Finite automata",
      "paragraphs": [
        "Now suppose α ∈ (0, 1) is a quadratic irrational. Then, as shown in [12], there is an algorithm to find a finite automaton M that takes n and x in parallel as inputs, represented in a certain numeration system, and accepts if and only if x = ⌊nα⌋. The numeration system required is the so-called Ostrowski α-numeration system, as discussed, for example, in [1, §3.9].",
        "Furthermore, we also know that we can algorithmically translate a first-order logical formula F involving addition, subtraction, comparisons, and other automata, into an automaton accepting the values of the free variables making F true [8].",
        "One strategy that initially seems plausible is to construct an automaton that takes m, n, z in parallel as input, and accepts if z is the number of distinct values of T (i, m, n) occurring over all i. If we had that, we could then accept those (m, n) pairs corresponding to z ≤ 2. However, this is not possible; we show in Section 5 that the number of distinct values taken by T (i, m, n) for m = n = F 3j /2 is Θ(j), where F t is the t'th Fibonacci number. This is impossible for an automaton that computes a function z from inputs m, n and accepts all three in parallel [13].",
        "Instead we can use the balance criterion stated in Lemma 1. This criterion is clearly expressible in first-order logic, since x = ⌊nα⌋ is expressible. We can then translate this first-order statement into an appropriate automaton that takes m and n as input (in the Ostrowski α-numeration system) and accepts if and only if the m × n blocks of the matrix A are balanced. We therefore get our main result.",
        "Theorem 2. There is an algorithm that, given a quadratic irrational α with 0 < α < 1, constructs a finite automaton that takes as input pairs (m, n), represented in the Ostrowski α-numeration system, and accepts if and only if the m × n blocks of the Sturmian matrix A α are balanced.",
        "Let us now carry out this construction in Walnut for the Fibonacci word, where α = (3 -√ 5)/2. We use the Zeckendorf numeration system [9,16], which represents integers as a sum of distinct Fibonacci numbers F j . A representation of n is written compactly as a binary word e i • • • e 2 , where n = 2≤j≤i e j F j .",
        "To implement the criterion in Lemma 1, we need to compute the difference T (i+1, m, n)-T (i, m, n) ∈ {-1, 0, 1}. Unfortunately we cannot write -1 in the ordinary Zeckendorf numeration system in Walnut, since it only deals with natural numbers. 1 To get around this problem, we work with the quantity",
        "The following Walnut code implements the criterion of Lemma 1. 2 For more about Walnut, see [11,14].",
        "This gives a 15-state automaton bal that accepts exactly those (m, n) pairs, in the Zeckendorf numeration system, that are balanced. An input consisting of a word made of pairs is accepted by the automaton if there is a path from state 0 labeled with those pairs. See Figure 1. We have therefore shown Corollary 3. The automaton in Figure 1 solves the balanced property for Fibonacci word rectangles.",
        "As an example, consider using the automaton to determine whether the 4 × 18 blocks are balanced. We represent 4 by 101 in the Zeckendorf system and 18 by 101000. Padding the shorter with 0 and entering the inputs in parallel [0, 1][0, 0][0, 1][1, 0][0, 0][1, 0] into the automaton in Figure 1, we start at state 0 and successively visit states 2, 6, 2, 7, 14, and 7 and accept. So (m, n) is balanced.",
        "As a special case, we can now recover the theorem of Anselmo et al., as follows: The bal automaton allows us to prove a wide variety of results about the (m, n)-balanced pairs for A γ . Here is one example.",
        "Proof. We use Walnut. For (a) we use the commands",
        "And Walnut returns TRUE.",
        "For (b) we use the commands",
        "And Walnut returns TRUE.",
        "We can also obtain a result about the density of balanced pairs (m, n). Proposition 6. Suppose F i < m ≤ F i+1 . Then for all n ≥ 1 there exists j, 1 ≤ j ≤ F i+1 , such that (m, n + j) is balanced. Furthermore the upper bound F i+1 is optimal for each m.",
        "Proof. We use Walnut. And Walnut returns TRUE.",
        "These results essentially say that the density of n for which (m, n) is balanced is lower bounded by (approximately) 1  φm .",
        "mentioned colors are meant to help the interested reader find the paths in Figure 2 corresponding to each regular expression. The \"upper part\" refers to the states 4, 8; the \"lower part\" to 2, 5 (and the state 10 belongs to both). Proof. We claim that",
        "To prove these claims we use Walnut and its capabilities of producing linear representations. A linear representation for a function f (n) is a triple (v, ζ, w) where v is a row vector, w is a column vector, and ζ is a matrix-valued morphism, such that f (n) = vζ(x)w for all representations of x that evaluate to n. In this case, of course, x is a Zeckendorf representation.",
        "Let us verify Eq. ( 4). We define three functions, as follows:",
        "• f (F 6n ) = T ((F 6n+2 -1)/4, F 6n /2, F 6n /2) for n ≥ 1, and f (t) = 0 for all other t.",
        "• g(F 6n ) = T ((F 6n-1 -1)/4, F 6n /2, F 6n /2) for n ≥ 1, and g(t) = 0 for all other t.",
        "• h(F 6n ) = 6n for n ≥ 1, and h(t) = 0 for all other t.",
        "Then Eq. ( 4) is equivalent to the claim that 3f (t) -3g(t) -h(t) = 0 for all t. Our strategy is to construct linear representations for each of the functions f (t), g(t), and h(t), using Walnut, and then combine them to find a linear representation for 3f (t) -3g(t) -h(t).",
        "Consider the following code: reg fib6 msd_fib \"0*1(000000)*0000\":",
        "k<t/2\": # t = F_{6n}, u = F_{6n-1} def numfib \"?msd_fib Ey $adjfib(x,y) & i<=y & $isfib(i)\": def numfib6 t \"?msd_fib $fib6(t) & $numfib(i,t)\": Here • fib6 accepts the Zeckendorf expansion of F 6n for n ≥ 1.",
        "• cnt6a generates a linear representation of rank 123 for the function f (t).",
        "• cnt6b generates a linear representation of rank 121 for the function g(t).",
        "• numfib(i, x) accepts if and only if x = F n for some n ≥ 2 and i = n.",
        "• numfib6 creates a linear representation of rank 14 for the function h(t).",
        "In Walnut these linear representations are provided as Maple files.",
        "From these linear representations we can easily compute, through standard matrix methods, a linear representation of rank 258 = 123 + 121 + 14 for 3g(t) -3f (t) -h(t). There is an algorithm to decide if a given linear representation represents the 0 function [4]. We use Walnut to create the representations and then a Maple program to check if 3f (t)-3g(t)-h(t) is identically 0. This proves Eq. ( 4), and Eq. ( 5) follows in a similar manner.",
        "Corollary 9. The number of distinct values of T (i, F 3n /2, F 3n /2) is Θ(n).",
        "Proof. From a result of Berthé and Tijdeman [6] we know that the number of distinct values of T (i, x, x) is O(log x). From Theorem 8 we know the number of distinct values of T (i, F 3n /2, F 3n /2) is Ω(n). Combining these gives the result."
      ],
      "subsections": []
    }
  ],
  "body_paragraphs": [
    "Let (a i ) i≥0 be an infinite sequence over {0, 1}. We can define an infinite matrix A = (a k,ℓ ) k,ℓ≥0 by a k,ℓ = a k+ℓ . Then we can view the m×n submatrices of A as matrices where the successive rows form shifted length-n \"windows\" of (a i ) i≥0 , and the entry in the upper left corner has index sum i: These are sometimes called Hankel matrices in the literature [10].",
    "The sum over all entries in the matrix A(i, m, n) equals",
    "It is clear that A(i, m, n) = A(i, n, m) for all i, m, n.",
    "The balance problem for (a i ) i≥0 is the following: for which pairs of natural numbers (m, n) are there at most two distinct values among all the (T (i, m, n)) i≥0 ? If this is the case, we say that the (m, n)-submatrices of A are balanced with respect to each other or just that (m, n) is balanced. This is a generalization of a more familiar notion of balance for binary words, one that has been well-studied [15].",
    "The famous infinite Fibonacci word f = f 0 f 1 f 2 • • • = 01001010 • • • has been the subject of numerous papers [3]. It can be defined via the formula",
    "for n ≥ 1, where γ = (3 -√ 5)/2. Recently Anselmo et al. [2] showed the following (their Theorem 18): for m, n ≥ 2, if max(m, n) is a Fibonacci number, then the m × n blocks of A γ are balanced. Also see [6]. However, there are still other (m, n) pairs with the balance property, such as (4,3). This raises the natural question, which (m, n) pairs are balanced for the Fibonacci word?",
    "In this note we prove a theorem (Corollary 3) characterizing exactly those pairs (m, n) that are balanced. Our characterization is in terms of finite automata. The particular result of Anselmo et al. then follows as a special case. More generally, we show how the same sort of characterization can be obtained for the matrices formed from any Sturmian word corresponding to a quadratic irrational α, and we show how to implement this in the free software Walnut.",
    "Let α ∈ (0, 1) be an irrational number, and define a i = ⌊(i + 1)α⌋ -⌊iα⌋ for i ≥ 1. The infinite word (a i ) i≥1 is sometimes called a Sturmian characteristic word [7,5]. Although by convention Sturmian words are indexed starting at 1, we can define a 0 = 0 without creating any new blocks that do not already appear in f , by a well-known result [5, 2.1.18].",
    "We now define the infinite matrix A α from the terms of (a i ) i≥1 ; we call A α a Sturmian matrix. By telescoping cancellation we see that",
    "Hence, from the definition (1), we get",
    "Note that for all x, y ≥ 0 we have ⌊x + y⌋ = ⌊x⌋ + ⌊y⌋ + δ with δ ∈ {0, 1}. Therefore,",
    "Define ∆(i, m, n) := T (i + 1, m, n) -T (i, m, n). The argument above then gives the following criterion for A(i, m, n) to be balanced. Lemma 1. If (a i ) i≥0 is a Sturmian word corresponding to the irrational number α, then in the matrix A α = (a i,j ) i,j≥0 the m×n blocks are balanced if and only if the sequence ∆(i, m, n) has no blocks of the form 1, 0, 0, . . . , 0, 1 or -1, 0, 0, . . . , 0, -1.",
    "Proof. The only thing left to show is that (∆(i, m, n)) i≥0 has a block of the form 1, 0, 0, . . . , 0, 1 or -1, 0, 0, . . . , 0, -1 if and only if (m, n) is not balanced.",
    "Suppose it does have a block of the form a, 0, 0, . . . , 0, a for a ∈ {-1, 1}; say there are",
    "Then by telescoping cancellation we have",
    "Without loss of generality we may assume that j -i is as small as possible. Since from Eq. ( 3) we know that ∆(i, m, n) ∈ {-1, 0, 1}, it follows that we must have ∆(j) = a, ∆(i) = a, and ∆(k) = 0 for i < k < j and a ∈ {-1, 1}.",
    "Now suppose α ∈ (0, 1) is a quadratic irrational. Then, as shown in [12], there is an algorithm to find a finite automaton M that takes n and x in parallel as inputs, represented in a certain numeration system, and accepts if and only if x = ⌊nα⌋. The numeration system required is the so-called Ostrowski α-numeration system, as discussed, for example, in [1, §3.9].",
    "Furthermore, we also know that we can algorithmically translate a first-order logical formula F involving addition, subtraction, comparisons, and other automata, into an automaton accepting the values of the free variables making F true [8].",
    "One strategy that initially seems plausible is to construct an automaton that takes m, n, z in parallel as input, and accepts if z is the number of distinct values of T (i, m, n) occurring over all i. If we had that, we could then accept those (m, n) pairs corresponding to z ≤ 2. However, this is not possible; we show in Section 5 that the number of distinct values taken by T (i, m, n) for m = n = F 3j /2 is Θ(j), where F t is the t'th Fibonacci number. This is impossible for an automaton that computes a function z from inputs m, n and accepts all three in parallel [13].",
    "Instead we can use the balance criterion stated in Lemma 1. This criterion is clearly expressible in first-order logic, since x = ⌊nα⌋ is expressible. We can then translate this first-order statement into an appropriate automaton that takes m and n as input (in the Ostrowski α-numeration system) and accepts if and only if the m × n blocks of the matrix A are balanced. We therefore get our main result.",
    "Theorem 2. There is an algorithm that, given a quadratic irrational α with 0 < α < 1, constructs a finite automaton that takes as input pairs (m, n), represented in the Ostrowski α-numeration system, and accepts if and only if the m × n blocks of the Sturmian matrix A α are balanced.",
    "Let us now carry out this construction in Walnut for the Fibonacci word, where α = (3 -√ 5)/2. We use the Zeckendorf numeration system [9,16], which represents integers as a sum of distinct Fibonacci numbers F j . A representation of n is written compactly as a binary word e i • • • e 2 , where n = 2≤j≤i e j F j .",
    "To implement the criterion in Lemma 1, we need to compute the difference T (i+1, m, n)-T (i, m, n) ∈ {-1, 0, 1}. Unfortunately we cannot write -1 in the ordinary Zeckendorf numeration system in Walnut, since it only deals with natural numbers. 1 To get around this problem, we work with the quantity",
    "The following Walnut code implements the criterion of Lemma 1. 2 For more about Walnut, see [11,14].",
    "This gives a 15-state automaton bal that accepts exactly those (m, n) pairs, in the Zeckendorf numeration system, that are balanced. An input consisting of a word made of pairs is accepted by the automaton if there is a path from state 0 labeled with those pairs. See Figure 1. We have therefore shown Corollary 3. The automaton in Figure 1 solves the balanced property for Fibonacci word rectangles.",
    "As an example, consider using the automaton to determine whether the 4 × 18 blocks are balanced. We represent 4 by 101 in the Zeckendorf system and 18 by 101000. Padding the shorter with 0 and entering the inputs in parallel [0, 1][0, 0][0, 1][1, 0][0, 0][1, 0] into the automaton in Figure 1, we start at state 0 and successively visit states 2, 6, 2, 7, 14, and 7 and accept. So (m, n) is balanced.",
    "As a special case, we can now recover the theorem of Anselmo et al., as follows: The bal automaton allows us to prove a wide variety of results about the (m, n)-balanced pairs for A γ . Here is one example.",
    "Proof. We use Walnut. For (a) we use the commands",
    "And Walnut returns TRUE.",
    "For (b) we use the commands",
    "And Walnut returns TRUE.",
    "We can also obtain a result about the density of balanced pairs (m, n). Proposition 6. Suppose F i < m ≤ F i+1 . Then for all n ≥ 1 there exists j, 1 ≤ j ≤ F i+1 , such that (m, n + j) is balanced. Furthermore the upper bound F i+1 is optimal for each m.",
    "Proof. We use Walnut. And Walnut returns TRUE.",
    "These results essentially say that the density of n for which (m, n) is balanced is lower bounded by (approximately) 1  φm .",
    "mentioned colors are meant to help the interested reader find the paths in Figure 2 corresponding to each regular expression. The \"upper part\" refers to the states 4, 8; the \"lower part\" to 2, 5 (and the state 10 belongs to both). Proof. We claim that",
    "To prove these claims we use Walnut and its capabilities of producing linear representations. A linear representation for a function f (n) is a triple (v, ζ, w) where v is a row vector, w is a column vector, and ζ is a matrix-valued morphism, such that f (n) = vζ(x)w for all representations of x that evaluate to n. In this case, of course, x is a Zeckendorf representation.",
    "Let us verify Eq. ( 4). We define three functions, as follows:",
    "• f (F 6n ) = T ((F 6n+2 -1)/4, F 6n /2, F 6n /2) for n ≥ 1, and f (t) = 0 for all other t.",
    "• g(F 6n ) = T ((F 6n-1 -1)/4, F 6n /2, F 6n /2) for n ≥ 1, and g(t) = 0 for all other t.",
    "• h(F 6n ) = 6n for n ≥ 1, and h(t) = 0 for all other t.",
    "Then Eq. ( 4) is equivalent to the claim that 3f (t) -3g(t) -h(t) = 0 for all t. Our strategy is to construct linear representations for each of the functions f (t), g(t), and h(t), using Walnut, and then combine them to find a linear representation for 3f (t) -3g(t) -h(t).",
    "Consider the following code: reg fib6 msd_fib \"0*1(000000)*0000\":",
    "k<t/2\": # t = F_{6n}, u = F_{6n-1} def numfib \"?msd_fib Ey $adjfib(x,y) & i<=y & $isfib(i)\": def numfib6 t \"?msd_fib $fib6(t) & $numfib(i,t)\": Here • fib6 accepts the Zeckendorf expansion of F 6n for n ≥ 1.",
    "• cnt6a generates a linear representation of rank 123 for the function f (t).",
    "• cnt6b generates a linear representation of rank 121 for the function g(t).",
    "• numfib(i, x) accepts if and only if x = F n for some n ≥ 2 and i = n.",
    "• numfib6 creates a linear representation of rank 14 for the function h(t).",
    "In Walnut these linear representations are provided as Maple files.",
    "From these linear representations we can easily compute, through standard matrix methods, a linear representation of rank 258 = 123 + 121 + 14 for 3g(t) -3f (t) -h(t). There is an algorithm to decide if a given linear representation represents the 0 function [4]. We use Walnut to create the representations and then a Maple program to check if 3f (t)-3g(t)-h(t) is identically 0. This proves Eq. ( 4), and Eq. ( 5) follows in a similar manner.",
    "Corollary 9. The number of distinct values of T (i, F 3n /2, F 3n /2) is Θ(n).",
    "Proof. From a result of Berthé and Tijdeman [6] we know that the number of distinct values of T (i, x, x) is O(log x). From Theorem 8 we know the number of distinct values of T (i, F 3n /2, F 3n /2) is Ω(n). Combining these gives the result.",
    "Actually, the negaFibonacci system is implemented in Walnut, so we could have used that. But we stick with the Zeckendorf representation system because it is more familiar.",
    "For an introduction to Walnut, see the Appendix."
  ],
  "references": [
    {
      "id": 1,
      "text": "Automatic Sequences\n\t\t\n\t\t\tJean-PaulAllouche\n\t\t\n\t\t\n\t\t\tJeffreyShallit\n\t\t\n\t\t10.1017/cbo9780511546563\n\t\t\n\t\t\t2003\n\t\t\tCambridge University Press"
    },
    {
      "id": 2,
      "text": "Fibonacci Pictures on a Binary Alphabet\n\t\t\n\t\t\tMarcellaAnselmo\n\t\t\n\t\t\n\t\t\tDoraGiammarresi\n\t\t\n\t\t\n\t\t\tMariaMadonia\n\t\t\n\t\t\n\t\t\tCarlaSelmi\n\t\t\n\t\t10.1007/978-3-031-97100-6_1\n\t\n\t\n\t\tLecture Notes in Computer Science\n\t\tLecture Notes in Computer Science\n\t\t\n\t\t\tAMalcher\n\t\t\n\t\t\n\t\t\tLPrigioniero\n\t\t\n\t\t\n\t\t\tSpringer Nature Switzerland\n\t\t\t2025\n\t\t\t15759"
    },
    {
      "id": 3,
      "text": "Fibonacci Words — A Survey\n\t\t\n\t\t\tJeanBerstel\n\t\t\n\t\t10.1007/978-3-642-95486-3_2\n\t\n\t\n\t\tThe Book of L\n\t\t\n\t\t\tGRozenberg\n\t\t\n\t\t\n\t\t\tASalomaa\n\t\t\n\t\t\n\t\t\tSpringer Berlin Heidelberg\n\t\t\t1986"
    },
    {
      "id": 4,
      "text": "Noncommutative Rational Series with Applications\n\t\t\n\t\t\tJeanBerstel\n\t\t\n\t\t\n\t\t\tChristopheReutenauer\n\t\t\n\t\t10.1017/cbo9780511760860\n\t\n\t\n\t\tof Encyclopedia of Mathematics and Its Applications\n\t\tNoncommutative Rational Series With Applications\n\t\t\n\t\t\tCambridge University Press\n\t\t\t2011\n\t\t\t137"
    },
    {
      "id": 5,
      "text": "Sturmian Words\n\t\t\n\t\t\tJBerstel\n\t\t\n\t\t\n\t\t\tPSéébold\n\t\t\n\t\t10.1017/cbo9781107326019.003\n\t\n\t\n\t\tAlgebraic Combinatorics on Words\n\t\t\n\t\t\tMLothaire\n\t\t\n\t\t\n\t\t\tCambridge University Press\n\t\t\t2002"
    },
    {
      "id": 6,
      "text": "Balance properties of multi-dimensional words\n\t\t\n\t\t\tValérieBerthé\n\t\t\n\t\t\n\t\t\tRobertTijdeman\n\t\t\n\t\t10.1016/s0304-3975(00)00441-2\n\t\n\t\n\t\tTheoretical Computer Science\n\t\tTheoretical Computer Science\n\t\t0304-3975\n\t\t\n\t\t\t273\n\t\t\t1-2\n\t\t\t\n\t\t\t2002\n\t\t\tElsevier BV"
    },
    {
      "id": 7,
      "text": "Descriptions of the Characteristic Sequence of an Irrational\n\t\t\n\t\t\tTomCBrown\n\t\t\n\t\t10.4153/cmb-1993-003-6\n\t\n\t\n\t\tCanadian Mathematical Bulletin\n\t\tCan. math. bull.\n\t\t0008-4395\n\t\t1496-4287\n\t\t\n\t\t\t36\n\t\t\t1\n\t\t\t\n\t\t\t1993\n\t\t\tCanadian Mathematical Society"
    },
    {
      "id": 8,
      "text": "Logic and {$p$}-recognizable sets of integers\n\t\t\n\t\t\tVéroniqueBruyàre\n\t\t\n\t\t\n\t\t\tGeorgesHansel\n\t\t\n\t\t\n\t\t\tChristianMichaux\n\t\t\n\t\t\n\t\t\tRogerVillemaire\n\t\t\n\t\t10.36045/bbms/1103408547\n\t\n\t\n\t\tBulletin of the Belgian Mathematical Society - Simon Stevin\n\t\tBull. Belg. Math. Soc. Simon Stevin\n\t\t1370-1444\n\t\t\n\t\t\t1\n\t\t\t2\n\t\t\t577\n\t\t\t1994. 1994\n\t\t\tThe Belgian Mathematical Society\n\t\t\n\t\n\tBull. Belgian Math. Soc."
    },
    {
      "id": 9,
      "text": "Voorstelling van natuurlijke getallen door een som van getallen van Fibonacci\n\t\t\n\t\t\tCGLekkerkerker\n\t\t\n\t\n\t\n\t\tSimon Stevin\n\t\t\n\t\t\t29\n\t\t\t\n\t\t\t1952"
    },
    {
      "id": 10,
      "text": "Low-Rank Approximation\n\t\t\n\t\t\tIvanMarkovsky\n\t\t\n\t\t10.1007/978-3-319-89620-5\n\t\t\n\t\t\t2019\n\t\t\tSpringer International Publishing\n\t\t\n\t\n\t2nd edition"
    },
    {
      "id": 11,
      "text": "Automatic theorem proving in Walnut\n\t\t\n\t\t\tHMousavi\n\t\t\n\t\tarXiv:1603.06017[cs.FL\n\t\t\n\t\t\n\t\t\t2016\n\t\t\n\t\n\tArXiv preprint"
    },
    {
      "id": 12,
      "text": "Beatty sequences for a quadratic irrational: decidability and applications\n\t\t\n\t\t\tLSchaeffer\n\t\t\n\t\t\n\t\t\tJShallit\n\t\t\n\t\t\n\t\t\tSZorcic\n\t\t\n\t\tarXiv:2402.08331\n\t\t\n\t\t\n\t\t\t2024\n\t\t\n\t\n\tArxiv preprint\n\tmath.NT"
    },
    {
      "id": 13,
      "text": "Synchronized Sequences\n\t\t\n\t\t\tJeffreyShallit\n\t\t\t0000-0003-1197-3820\n\t\t\n\t\t10.1007/978-3-030-85088-3_1\n\t\n\t\n\t\tLecture Notes in Computer Science\n\t\tLecture Notes in Computer Science\n\t\t\n\t\t\tTLecroq\n\t\t\n\t\t\n\t\t\tSPuzynina\n\t\t\n\t\t\n\t\t\tSpringer International Publishing\n\t\t\t2021\n\t\t\t12847"
    },
    {
      "id": 14,
      "text": "The Logical Approach to Automatic Sequences\n\t\t\n\t\t\tJeffreyShallit\n\t\t\n\t\t10.1017/9781108775267\n\t\n\t\n\t\tLondon Mathematical Society Lecture Note Series\n\t\t\n\t\t\t482\n\t\t\t2023\n\t\t\tCambridge University Press"
    },
    {
      "id": 15,
      "text": "Balanced words\n\t\t\n\t\t\tLaurentVuillon\n\t\t\n\t\t10.36045/bbms/1074791332\n\t\n\t\n\t\tBulletin of the Belgian Mathematical Society - Simon Stevin\n\t\tBull. Belg. Math. Soc. Simon Stevin\n\t\t1370-1444\n\t\t\n\t\t\t10\n\t\t\t5\n\t\t\t2003\n\t\t\t\n\t\t\tThe Belgian Mathematical Society"
    },
    {
      "id": 16,
      "text": "Représentation des nombres comme somme de deux carrés\n\t\t\n\t\t\tEZeckendorf\n\t\t\n\t\t10.1007/2-287-33846-2_4\n\t\n\t\n\t\tRaisonnements divins\n\t\t\n\t\t\tSpringer Paris\n\t\t\t1972\n\t\t\t41"
    }
  ],
  "formulas": [
    {
      "id": "FORMULA_1",
      "raw": "A(i, m, n) :=     "
    },
    {
      "id": "FORMULA_2",
      "raw": "T (i, m, n) := m-1 k=0 n-1 ℓ=0 a i+k+ℓ .(1)"
    },
    {
      "id": "FORMULA_3",
      "raw": "f n-1 = ⌊(n + 1)γ⌋ -⌊nγ⌋ ∈ {0, 1},"
    },
    {
      "id": "FORMULA_4",
      "raw": "j≤i≤k a i = ⌊(k + 1)α⌋ -⌊jα⌋."
    },
    {
      "id": "FORMULA_5",
      "raw": "T (i + 1, m, n) -T (i, m, n) = (a i+n + • • • + a i+m+n-1 ) -(a i + • • • + a i+m-1 ) = (⌊(i + m + n)α⌋ -⌊(i + n)α⌋) -(⌊(i + m)α⌋ -⌊iα⌋).(2)"
    },
    {
      "id": "FORMULA_6",
      "raw": "⌊(i + m + n)α⌋ -⌊(i + n)α⌋ = ⌊mα⌋ + δ 1 and ⌊(i + m)α⌋ -⌊iα⌋ = ⌊mα⌋ + δ 2 , with δ 1 , δ 2 ∈ {0, 1}. Thus, T (i + 1, m, n) -T (i, m, n) = δ 1 -δ 2 ∈ {-1, 0, 1}.(3)"
    },
    {
      "id": "FORMULA_7",
      "raw": "indices i < j such that ∆(i, m, n) = a, ∆(j, m, n) = a and ∆(k, m, n) = 0 for i < k < j."
    },
    {
      "id": "FORMULA_8",
      "raw": "T (j + 1, m, n) = T (i, m, n) + 2a, proving that (m, n) is not balanced. Now suppose (m, n) is not balanced, meaning that there exist i < j such that |T (i, m, n)- T (j + 1, m, n)| ≥ 2."
    },
    {
      "id": "FORMULA_9",
      "raw": "T (i + 1, m, n) -T (i, m, n) + 1 ∈ {0, 1, 2} instead."
    },
    {
      "id": "FORMULA_10",
      "raw": "reg shift {0,1} {0,1} \"([0,0]|[0,1][1,1]*[1,0])*\": # accepts x,"
    },
    {
      "id": "FORMULA_11",
      "raw": "# z = Delta(i,m,n) + 1 = T(i+1,m,n)-T(i,m,n)+1 def bal \"?msd_fib ~Ei,j i>0 & i<j & (($diff(i,m,n,2) & (Ak (i<k & k<j) => $diff(k,m,n,1)) & $diff(j,m,n,2)) | ($diff(i,m,n,0) & (Ak (i<k & k<j) => $diff(k,m,n,1)) & $diff(j,m,n,0)))\": # implements the balance criterion of Lemma 1"
    },
    {
      "id": "FORMULA_12",
      "raw": "0 [0,0] 1 [1,0] 2 [0,1] 3 [1,1] 4 [0,0] 5 [0,1] 6 [0,0] 7 [1,0] 8 [0,0] [1,0] [1,1] 9 [0,0] 10 [0,1] 11 [0,0] [0,1] [1,1] 12 [0,0] 13 [1,0] 14 [0,0] [0,1] [1,0] [0,0] [1,0] [1,1] [0,0] [0,1] [1,0] [0,0] [0,1] [0,0] [0,1] [1,1] [0,0] [1,0] [0,1] [0,0] [1,0] [0,0]"
    },
    {
      "id": "FORMULA_13",
      "raw": "Proposition 5. Let n ≥ 2. (a) (i, j) is balanced if and only if (i ′ , j) is balanced, for F n+1 < i, i ′ < F n+2 and j ≥ F n-1 . (b) (F n+1 + i, j) is balanced if and only if (F n+2 -i, j) is balanced, for 1 ≤ i < F n and j ≥ 1."
    },
    {
      "id": "FORMULA_14",
      "raw": "reg adjfib msd_fib msd_fib \"[0,0]*[0,1][1,0][0,0]*\": # accepts (F_n, F_{n+1}) for n>=2 eval claima \"?msd_fib Au,v,x,i,ip,j ($adjfib(u,v) & x=u+v & i>v & ip>v & i<x &ip<x & j>=v-u) => ($bal(i,j) <=> $bal(ip,j))\": # u = F_{n}, v = F_{n+1}, x = F_{n+2}"
    },
    {
      "id": "FORMULA_15",
      "raw": "eval claimb \"?msd_fib Au,v,x,i,j ($adjfib(u,v) & x=u+v & i>=1 & i<u & j>=1) => ($bal(v+i,j) <=> $bal(x-i,j))\": # u = F_n, v = F_{n+1}, x = F_{n+2}"
    },
    {
      "id": "FORMULA_16",
      "raw": "T ((F 6n-1 -1)/4, F 6n /2, F 6n /2) -T ((F 6n+2 -1)/4, F 6n /2, F 6n /2) = 2n (4) T ((F 6n+5 -1)/4, F 6n+3 /2, F 6n+3 /2) -T ((F 6n+2 -1)/4, F 6n+3 /2, F 6n+3 /2) = 2n + 1. (5)"
    },
    {
      "id": "FORMULA_17",
      "raw": "def cnt6a t \"?msd_fib $fib6(t) & Ex,y $adjfib(t,x) & $adjfib(x,y) & F[(y-1)/4+j+k]=@1 & j<t/2 & k<t/2\": # t = F_{6n}, x = F_{6n+1}, y = F_{6n+2} def cnt6b t \"?msd_fib $fib6(t) & Eu $adjfib(u,t) & F[(u-1)/4+j+k]=@1 & j<t/2 &"
    }
  ]
}